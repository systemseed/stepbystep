# Step By Step Drupal distribution

Step By Step is a Drupal distribution for an evidence based support program
for people with depression and stress.

## Installation

### Requirements

- Composer
- PHP 7.4+

For more details, check [Drupal 9 system requirements](https://www.drupal.org/docs/system-requirements).

### Installing from Composer template

This is the quickest way to setup Step By Step project.

Run the command below to create a new Composer project for Step By Step.

```
composer create-project systemseed/who-stepbystep-project stepbystep --stability=dev --repository="{\"url\": \"git@github.com:systemseed/who-stepbystep-project.git\", \"type\": \"vcs\"}"
```

During installation, you may be asked for a GitHub auth token. Follow Composer
instructions to generate GitHub token and provide it when asked by Composer
installer.

Install your Step By Step site like any other Drupal website using the
install.php script or drush.

Example Drush command:

```
drush site:install stepbystep --account-name=sbssuperadmin --site-name="Step by Step"  --yes
```

### Installing into another Composer project

You can add Step By Step into another Composer file (for example, the one
generated by `drupal/recommended-project`).

Ensure all required repositories are addded in the `repositories` array. You can
find up-to-date list in [composer.json of the template project](https://github.com/systemseed/who-stepbystep-project/blob/9.x/composer.json).

Ensure minimum stability of your composer project is set to `dev`:
```
composer config minimum-stability dev
```

Require Step By Step profile package:

```
make composer req systemseed/who-stepbystep:"9.x-dev"
```

Install your Step By Step site like any other Drupal website.

### Enabling development mode (NOT FOR PRODUCTION!)

The profile comes with preconfigured development mode for quick testing on dev
environments. The development mode is powered by `config_split` module.

To enable development mode, you need to perform the following steps.

Install `devel_php`:
```
composer req --dev drupal/devel_php
```

Enable development config split and test users by adding the following lines
in settings.php:

```
$settings['config_sync_directory'] = '../config/sync';
$config["config_split.config_split.development"]["status"] = TRUE;
```

Export your current configuration in `./config/sync`:
```
drush config-export
```

Copy preconfigured config splits into your config folder:

```
cp -r web/profiles/contrib/who-stepbystep/config/split config/
```

Clear cache, run config import, run cron:
```
drush cr
drush config-import
drush cron
```

The development mode enables:

- Quick registration with dev+YOURNAME@whostepbystep.oeg email addresses
- Test users for each existing role:
  - dev+developer@whostepbystep.org
  - dev+manager@whostepbystep.org
  - dev+coordinator@whostepbystep.org
  - dev+e_helper@whostepbystep.org
  - dev+content_editor@whostepbystep.org
  - dev+translator@whostepbystep.org
  - dev+authenticated@whostepbystep.org

### Configuration

Before running the site on production the following configuration must be
reviewed:
- TBD

### Update

TBD

### Contribute
